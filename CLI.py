import argparse
import json


class CLI:

    @staticmethod
    def interface():
        parser = argparse.ArgumentParser()
        parser.add_argument("-p", "--product",
                            help="Product / operating system name, case insensitive,"
                                 " i.e. \"Red Hat Enterprise Linux 8.2\"",
                            action="append",
                            type=str
                            )
        parser.add_argument("-f", "--format",
                            help="Response format: JSON, XML or HTML",
                            action="store")
        parser.add_argument("-a", "--advisories",
                            help="Only show CVEs with RHSA advisories, if not specified shows all CVEs."
                                 "Applicable only to products supported by Red Hat API.",
                            action="store_true")
        parser.add_argument("-d", "--dump",
                            help="Dumping results to a file. Requires filename.",
                            action="store",
                            type=str)
        parser.add_argument("-pp", "--pretty-print",
                            help="Pretty prints the JSON output into console if specified",
                            action="store_true")
        parser.add_argument("--after",
                            help="Show only vulnerabilities after specified date in format YYYY-MM-DD",
                            action="store",
                            type=str)
        parser.add_argument("--before",
                            help="Show only vulnerabilities detected before specified date in format YYYY-MM-DD",
                            action="store",
                            type=str
                            )
        parser.add_argument("--severity",
                            help="Show only vulnerabilities with specified severity. ",
                            action="store",
                            type=str)
        return parser.parse_args()

    @staticmethod
    def dump_to_file(data, filename):
        with open(filename, "w") as f:
            json.dump(data, f)
